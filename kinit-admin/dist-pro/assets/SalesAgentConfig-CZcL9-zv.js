var P=Object.defineProperty;var N=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var T=(m,o,n)=>o in m?P(m,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[o]=n,z=(m,o)=>{for(var n in o||(o={}))R.call(o,n)&&T(m,n,o[n]);if(N)for(var n of N(o))J.call(o,n)&&T(m,n,o[n]);return m};var x=(m,o,n)=>new Promise((V,g)=>{var w=s=>{try{k(n.next(s))}catch(d){g(d)}},I=s=>{try{k(n.throw(s))}catch(d){g(d)}},k=s=>s.done?V(s.value):Promise.resolve(s.value).then(w,I);k((n=n.apply(m,o)).next())});import{l as Z,Z as y,a as $,d as G,m as Q,p as W,q as c,U as t,a8 as X,u as a,O as p,S as f,T as E,aH as Y,aI as ee}from"./vue-chunks-o2h5QaLn.js";import{_ as te}from"./index-BSaZkSQ-.js";/* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                      *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                       */import{i as ae,j as le,k as oe,l as ie,m as se}from"./customer-DILA4COA.js";import{D as b,d as _,t as h,u as ne,v as de,H as j,B as re,C as S,b as C,w as pe}from"./element-plus-BkD8NzPH.js";const A=m=>(Y("data-v-c0b45f86"),m=m(),ee(),m),ue={class:"p-4"},me={class:"flex items-center justify-between mb-4"},ce={class:"flex items-center space-x-2"},fe={class:"text-sm text-gray-500"},ge={class:"mt-4 flex justify-end"},ve={class:"space-y-2"},_e=A(()=>c("strong",null,"名称：",-1)),be=A(()=>c("strong",null,"手机号：",-1)),ye=A(()=>c("div",null,[c("strong",null,"描述：")],-1)),he=A(()=>c("div",null,[c("strong",null,"配置：")],-1)),Ce=Z({__name:"SalesAgentConfig",setup(m){const o=y({page:1,limit:10,total:0,v_order:"desc"}),n=$([]),V=y({keyword:""}),g=()=>x(this,null,function*(){var e;const l={page:o.page,limit:o.limit,keyword:V.keyword,v_order:o.v_order};try{const u=yield ae(l);u&&u.data?(n.value=u.data||[],o.total=(e=u.data.total)!=null?e:0):(n.value=[],o.total=0)}catch(u){console.error(u),C.error("获取配置列表失败")}}),w=()=>{o.page=1,g()},I=l=>{o.page=l,g()},k=l=>{o.limit=l,o.page=1,g()},s=y({visible:!1,data:null}),d=y({visible:!1,isEdit:!1,data_id:0}),U=$(),r=y({name:"",phone:"",description:"",config:""}),q=y({name:[{required:!0,message:"请输入名称",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"}]}),F=l=>{l!=null&&l.id?le(l.id).then(e=>{var u;s.data=(u=e==null?void 0:e.data)!=null?u:l,s.visible=!0}).catch(()=>{s.data=l,s.visible=!0}):(s.data=l,s.visible=!0)},L=l=>{var e,u,i,v;d.isEdit=!0,d.data_id=l.id,r.name=(e=l.name)!=null?e:"",r.phone=(u=l.phone)!=null?u:"",r.description=(i=l.description)!=null?i:"",r.config=(v=l.config)!=null?v:"",d.visible=!0},M=()=>{d.isEdit=!1,d.data_id=0,r.name="",r.phone="",r.description="",r.config="",d.visible=!0},O=()=>{d.visible=!1},H=()=>{var l,e;(e=(l=U.value)==null?void 0:l.validate)==null||e.call(l,u=>x(this,null,function*(){if(u)try{d.isEdit&&d.data_id?(yield oe(d.data_id,z({},r)),C.success("更新成功")):(yield ie(z({},r)),C.success("创建成功")),d.visible=!1,g()}catch(i){C.error("操作失败")}}))},K=l=>{pe.confirm("确认删除该配置吗？","删除确认",{type:"warning"}).then(()=>x(this,null,function*(){try{yield se([l.id]),C.success("删除成功"),g()}catch(e){C.error("删除失败")}})).catch(()=>{})};return G(()=>{g()}),(l,e)=>{var u;return Q(),W("div",ue,[c("div",me,[c("div",ce,[t(a(b),{modelValue:V.keyword,"onUpdate:modelValue":e[0]||(e[0]=i=>V.keyword=i),placeholder:"搜索姓名或手机号",clearable:"",onClear:w,onKeydown:X(w,["enter"])},null,8,["modelValue"]),t(a(_),{plain:!0,onClick:w},{default:p(()=>[f("搜索")]),_:1}),t(a(_),{type:"primary",onClick:M},{default:p(()=>[f("创建配置")]),_:1})]),c("div",fe,"总数："+E(o.total),1)]),t(a(ne),{data:n.value,stripe:"",style:{width:"100%"},"empty-text":"暂无数据"},{default:p(()=>[t(a(h),{prop:"id",label:"ID",width:"80"}),t(a(h),{prop:"name",label:"名称"}),t(a(h),{prop:"phone",label:"手机号"}),t(a(h),{prop:"description",label:"描述","show-overflow-tooltip":""}),t(a(h),{prop:"config",label:"配置","show-overflow-tooltip":""}),t(a(h),{label:"操作",width:"220"},{default:p(i=>[t(a(_),{size:"small",onClick:v=>F(i.row)},{default:p(()=>[f("查看")]),_:2},1032,["onClick"]),t(a(_),{size:"small",type:"primary",onClick:v=>L(i.row)},{default:p(()=>[f("编辑")]),_:2},1032,["onClick"]),t(a(_),{size:"small",type:"danger",onClick:v=>K(i.row)},{default:p(()=>[f("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",ge,[t(a(de),{background:"",layout:"prev, pager, next, sizes, total","page-size":o.limit,"current-page":o.page,"page-sizes":[10,20,50,100],total:o.total,onSizeChange:k,onCurrentChange:I},null,8,["page-size","current-page","total"])]),t(a(j),{modelValue:s.visible,"onUpdate:modelValue":e[2]||(e[2]=i=>s.visible=i),width:"640px",title:"业务员配置 - "+(((u=s.data)==null?void 0:u.name)||"")},{footer:p(()=>[t(a(_),{onClick:e[1]||(e[1]=i=>s.visible=!1)},{default:p(()=>[f("关闭")]),_:1})]),default:p(()=>{var i,v,D,B;return[c("div",ve,[c("div",null,[_e,f(E((i=s.data)==null?void 0:i.name),1)]),c("div",null,[be,f(E((v=s.data)==null?void 0:v.phone),1)]),ye,t(a(b),{type:"textarea",rows:3,"model-value":(D=s.data)==null?void 0:D.description,disabled:""},null,8,["model-value"]),he,t(a(b),{type:"textarea",rows:6,"model-value":(B=s.data)==null?void 0:B.config,disabled:""},null,8,["model-value"])])]}),_:1},8,["modelValue","title"]),t(a(j),{modelValue:d.visible,"onUpdate:modelValue":e[7]||(e[7]=i=>d.visible=i),width:"700px",title:d.isEdit?"编辑配置":"创建配置"},{footer:p(()=>[t(a(_),{onClick:O},{default:p(()=>[f("取消")]),_:1}),t(a(_),{type:"primary",onClick:H},{default:p(()=>[f(E(d.isEdit?"保存":"创建"),1)]),_:1})]),default:p(()=>[t(a(re),{model:r,rules:q,ref_key:"formRef",ref:U,"label-width":"120px",class:"space-y-2"},{default:p(()=>[t(a(S),{label:"名称",prop:"name"},{default:p(()=>[t(a(b),{modelValue:r.name,"onUpdate:modelValue":e[3]||(e[3]=i=>r.name=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"手机号",prop:"phone"},{default:p(()=>[t(a(b),{modelValue:r.phone,"onUpdate:modelValue":e[4]||(e[4]=i=>r.phone=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"描述",prop:"description"},{default:p(()=>[t(a(b),{type:"textarea",rows:3,modelValue:r.description,"onUpdate:modelValue":e[5]||(e[5]=i=>r.description=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"配置(JSON或文本)",prop:"config"},{default:p(()=>[t(a(b),{type:"textarea",rows:8,modelValue:r.config,"onUpdate:modelValue":e[6]||(e[6]=i=>r.config=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),qe=te(Ce,[["__scopeId","data-v-c0b45f86"]]);export{qe as default};
