var f=(P,h,p)=>new Promise((_,y)=>{var D=s=>{try{u(p.next(s))}catch(c){y(c)}},A=s=>{try{u(p.throw(s))}catch(c){y(c)}},u=s=>s.done?_(s.value):Promise.resolve(s.value).then(D,A);u((p=p.apply(P,h)).next())});import{g as G,d as H,a as J,p as K}from"./menu-CtZuxorH.js";import{u as Q,_ as U}from"./Table.vue_vue_type_script_lang-C8htGDV6.js";import{d as q,I as W,v}from"./index-SAHUQZ2g.js";/* empty css                  *//* empty css               */import{_ as X}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bq-Mkqar.js";import{_ as Y}from"./Write.vue_vue_type_script_setup_true_lang-DJJq5U8b.js";import{_ as Z}from"./Dialog.vue_vue_type_style_index_0_lang-Bhm9ynpg.js";import{u as ee}from"./dict-D8O779xT.js";import{s as te}from"./dict-DJyIMlYA.js";import{V as R,p as ae,j as le}from"./element-plus-C0vem28W.js";import{f as oe,a as i,Q as ie,M as a,F as m,H as x,ag as C,K as w,h as M,i as se,G as r,u as l,E as B,L as E,J as re}from"./vue-chunks-wbK7PffK.js";/* empty css                       *//* empty css                 *//* empty css                   *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                        *//* empty css                */import"./useForm-B5RQKQQi.js";/* empty css                     *//* empty css                 *//* empty css                          *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-BFkgkg1x.js";import"./wang-editor-K_dPeC8b.js";/* empty css                   *//* empty css                    *//* empty css                         */import"./_Uint8Array-DZlgfqcV.js";import"./useValidator-UROf_CnT.js";/* empty css                  */import"./dict-D1Ddn9_W.js";const Ye=oe({name:"AuthMenu",__name:"Menu",setup(P){const{t:h}=q(),{tableRegister:p,tableState:_,tableMethods:y}=Q({fetchDataApi:()=>f(this,null,function*(){const{pageSize:t,currentPage:e}=_,o=yield G({page:l(e),limit:l(t)});return{list:o.data||[],total:o.count||0}}),fetchDelApi:t=>f(this,null,function*(){return(yield H(t)).code===200})}),{dataList:D,loading:A}=_,{getList:u,delList:s}=y;let c=i([]);f(this,null,function*(){const e=yield ee().getDictObj(["sys_vadmin_menu_type"]);c.value=e.sys_vadmin_menu_type});const F=ie([{field:"title",label:"菜单名称",width:"200px",disabled:!0,show:!0},{field:"icon",label:"图标",width:"120px",show:!1,slots:{default:t=>{const e=t.row;return a(m,null,[e.icon?a(W,{icon:e.icon},null):""])}}},{field:"order",label:"排序",width:"120px",show:!0},{field:"menu_type",label:"菜单类型",width:"120px",show:!0,slots:{default:t=>{const e=t.row;return a(m,null,[a("span",null,[te(c.value,e.menu_type)])])}}},{field:"perms",label:"权限标识",width:"150px",show:!0},{field:"path",label:"路由地址",show:!0},{field:"component",label:"组件路径",show:!0},{field:"noCache",label:"页面缓存",width:"120px",show:!0,slots:{default:t=>{const e=t.row;return a(m,null,[a(R,{modelValue:!e.noCache,disabled:!0},null)])}}},{field:"hidden",label:"显示状态",width:"120px",show:!0,slots:{default:t=>{const e=t.row;return a(m,null,[a(R,{modelValue:!e.hidden,disabled:!0},null)])}}},{field:"disabled",label:"菜单状态",width:"120px",show:!0,slots:{default:t=>{const e=t.row;return a(m,null,[a(R,{modelValue:!e.disabled,disabled:!0},null)])}}},{field:"action",width:"200px",label:"操作",show:!0,slots:{default:t=>{const e=t.row,o=["auth.menu.update"],k=["auth.menu.create"],j=["auth.menu.delete"];return a(m,null,[x(a(v,{type:"primary",link:!0,size:"small",onClick:()=>T(e)},{default:()=>[w("编辑")]}),[[C("hasPermi"),o]]),x(a(v,{type:"primary",link:!0,size:"small",onClick:()=>I(e)},{default:()=>[w("添加子菜单")]}),[[C("hasPermi"),k]]),x(a(v,{type:"danger",loading:L.value,link:!0,size:"small",onClick:()=>O(e)},{default:()=>[w("删除")]}),[[C("hasPermi"),j]])])}}}]),L=i(!1),O=t=>f(this,null,function*(){L.value=!0,yield s(!0,[t.id]).finally(()=>{L.value=!1})}),n=i(!1),g=i(""),b=i(),V=i(void 0),d=i(""),$=i(),S=i(!1),T=t=>{g.value="编辑",d.value="edit",b.value=t,n.value=!0},z=()=>{g.value="新增",d.value="add",b.value=void 0,n.value=!0},I=t=>{g.value="添加子菜单",d.value="addSon",V.value=t.id,b.value=void 0,n.value=!0},N=()=>f(this,null,function*(){const t=l($),e=yield t==null?void 0:t.submit();if(e){S.value=!0;try{const o=i({});d.value==="add"||d.value==="addSon"?(o.value=yield J(e),o.value&&(V.value=void 0,n.value=!1,u())):d.value==="edit"&&(o.value=yield K(e),o.value&&(n.value=!1,u()))}finally{S.value=!1}}});return(t,e)=>{const o=C("hasPermi");return M(),se(m,null,[a(l(X),null,{default:r(()=>[a(l(U),{columns:F,showAction:"","default-expand-all":"","node-key":"id",data:l(D),loading:l(A),onRegister:l(p),onRefresh:l(u)},{toolbar:r(()=>[a(l(ae),{gutter:10},{default:r(()=>[a(l(le),{span:1.5},{default:r(()=>[x((M(),B(l(v),{type:"primary",onClick:z},{default:r(()=>[w("新增菜单")]),_:1})),[[o,["auth.menu.create"]]])]),_:1})]),_:1})]),_:1},8,["columns","data","loading","onRegister","onRefresh"])]),_:1}),a(l(Z),{modelValue:n.value,"onUpdate:modelValue":e[1]||(e[1]=k=>n.value=k),title:g.value},{footer:r(()=>[d.value!=="detail"?(M(),B(l(v),{key:0,type:"primary",loading:S.value,onClick:N},{default:r(()=>[w(E(l(h)("exampleDemo.save")),1)]),_:1},8,["loading"])):re("",!0),a(l(v),{onClick:e[0]||(e[0]=k=>n.value=!1)},{default:r(()=>[w(E(l(h)("dialogDemo.close")),1)]),_:1})]),default:r(()=>[a(Y,{ref_key:"writeRef",ref:$,"current-row":b.value,"parent-id":V.value},null,8,["current-row","parent-id"])]),_:1},8,["modelValue","title"])],64)}}});export{Ye as default};
