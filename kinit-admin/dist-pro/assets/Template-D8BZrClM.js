var oe=Object.defineProperty;var q=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var K=(g,d,r)=>d in g?oe(g,d,{enumerable:!0,configurable:!0,writable:!0,value:r}):g[d]=r,B=(g,d)=>{for(var r in d||(d={}))re.call(d,r)&&K(g,r,d[r]);if(q)for(var r of q(d))ne.call(d,r)&&K(g,r,d[r]);return g};var b=(g,d,r)=>new Promise((x,f)=>{var k=c=>{try{_(r.next(c))}catch(u){f(u)}},m=c=>{try{_(r.throw(c))}catch(u){f(u)}},_=c=>c.done?x(c.value):Promise.resolve(c.value).then(k,m);_((r=r.apply(g,d)).next())});import{f as de,a as h,Q as I,d as ue,ag as pe,h as V,i as j,j as z,M as t,G as l,F as O,$ as P,E as A,u as e,K as n,L as C,a0 as me,H as ce,J as ge,n as Q}from"./vue-chunks-wbK7PffK.js";import{s as fe,_ as ve}from"./index-SAHUQZ2g.js";/* empty css                  *//* empty css                   *//* empty css                     *//* empty css                 *//* empty css                       *//* empty css                  *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                 *//* empty css                       *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{G as U,F as $,D as F,a as N,I as _e,d as v,J as be,K as we,t as w,L as ye,u as he,v as Ve,B as Ce,C as L,M as xe,N as G,H as ke,w as Ee,b as R}from"./element-plus-C0vem28W.js";import{h as Te,i as De,u as ze,j as Ae}from"./questiong-rnLsr9Ml.js";import{s as Ue}from"./dict-DJyIMlYA.js";const Le={class:"p-4 bg-white rounded-lg shadow"},Se={class:"flex justify-between items-center mb-4"},Be={class:"flex items-center space-x-2"},Ie={class:"flex justify-end mt-4"},je={class:"dialog-footer"},Qe=de({__name:"Template",props:{tabParams:{type:Object,default:()=>({})}},emits:["switch-tab"],setup(g,{emit:d}){const r=d,x=h(!1),f=h(!1),k=h(!1),m=h("add"),_=h(),c=h([]),u=I({title:"",status:void 0,sale_agent_id:void 0}),p=I({page:1,limit:10,total:0,v_order:"desc"}),o=I({title:"",description:"",status:1,sale_agent_id:0}),H={title:[{required:!0,message:"请输入标题",trigger:"blur"},{min:1,max:125,message:"标题长度在 1 到 125 个字符",trigger:"blur"}],description:[{required:!0,message:"请输入描述",trigger:"blur"},{min:1,max:2048,message:"描述长度在 1 到 2048 个字符",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],sale_agent_id:[{required:!0,message:"请输入售前代理ID",trigger:"blur"},{type:"number",min:0,message:"售前代理ID不能为负数",trigger:"blur"}]},D=h([]),M=i=>i?new Date(i).toLocaleString():"-",E=()=>{p.page=1,y()},J=()=>{u.title="",u.status=void 0,p.page=1,y()},W=i=>{p.limit=i,p.page=1,y()},X=i=>{p.page=i,y()},Y=()=>{var i;o.title="",o.description="",o.status=1,o.sale_agent_id=0,(i=_.value)==null||i.clearValidate()},Z=()=>{m.value="add",f.value=!0,Q(()=>{Y()})},ee=i=>b(this,null,function*(){m.value="edit",f.value=!0,Q(()=>{Object.assign(o,i)})}),ae=i=>b(this,null,function*(){r("switch-tab",{tabName:"QAndA",params:i})}),te=i=>b(this,null,function*(){m.value="view",f.value=!0,Q(()=>{Object.assign(o,i)})}),le=i=>b(this,null,function*(){try{yield Ee.confirm(`确定要删除问题模板 "${i.title}" 吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),yield Te([i.id]),R.success("删除成功"),y()}catch(s){}}),se=()=>b(this,null,function*(){if(!(!_.value||!(yield _.value.validate()))){k.value=!0;try{m.value==="add"?(yield De(o),R.success("新增成功")):m.value==="edit"&&(yield ze(o.id,o),R.success("更新成功")),f.value=!1,y()}catch(s){}finally{k.value=!1}}}),y=()=>b(this,null,function*(){x.value=!0;try{const i=B(B({},u),p),s=yield Ae(i);c.value=s.data||[],p.total=s.data.total||0}catch(i){c.value=[],p.total=0}finally{x.value=!1}}),ie=()=>b(this,null,function*(){yield fe().then(i=>{let s=i.data;s=s.map(T=>({label:T.name||T.nickname,value:T.id||1})),D.value=s})});return ue(()=>{y(),ie()}),(i,s)=>{const T=pe("loading");return V(),j("div",Le,[z("div",Se,[z("div",Be,[t(e($),{modelValue:u.sale_agent_id,"onUpdate:modelValue":s[0]||(s[0]=a=>u.sale_agent_id=a),placeholder:"业务员",clearable:"",style:{width:"120px"},onChange:E},{default:l(()=>[(V(!0),j(O,null,P(D.value,a=>(V(),A(e(U),{key:a.value,value:a.value,label:a.label},{default:l(()=>[n(C(a.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"]),t(e(F),{modelValue:u.title,"onUpdate:modelValue":s[1]||(s[1]=a=>u.title=a),placeholder:"搜索标题",clearable:"",style:{width:"200px"},onClear:E,onKeyup:me(E,["enter"])},null,8,["modelValue"]),t(e($),{modelValue:u.status,"onUpdate:modelValue":s[2]||(s[2]=a=>u.status=a),placeholder:"状态",clearable:"",style:{width:"120px"},onChange:E},{default:l(()=>[t(e(U),{label:"启用",value:1}),t(e(U),{label:"禁用",value:0})]),_:1},8,["modelValue"]),t(e(v),{type:"primary",onClick:E},{default:l(()=>[t(e(N),null,{default:l(()=>[t(e(_e))]),_:1}),n(" 搜索 ")]),_:1}),t(e(v),{onClick:J},{default:l(()=>[t(e(N),null,{default:l(()=>[t(e(be))]),_:1}),n(" 重置 ")]),_:1})]),t(e(v),{type:"primary",onClick:Z},{default:l(()=>[t(e(N),null,{default:l(()=>[t(e(we))]),_:1}),n(" 新增模板 ")]),_:1})]),ce((V(),A(e(he),{data:c.value,border:"",stripe:"",style:{width:"100%"}},{default:l(()=>[t(e(w),{prop:"id",label:"ID",width:"80",align:"center"}),t(e(w),{prop:"title",label:"标题","min-width":"150","show-overflow-tooltip":""}),t(e(w),{prop:"description",label:"描述","min-width":"200","show-overflow-tooltip":""}),t(e(w),{prop:"status",label:"状态",width:"100",align:"center"},{default:l(a=>[t(e(ye),{type:a.row.status===1?"success":"danger",size:"small"},{default:l(()=>[n(C(a.row.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(e(w),{prop:"sale_agent_id",label:"业务员",width:"120",align:"center"},{default:l(a=>[n(C(e(Ue)(D.value,a.row.sale_agent_id)),1)]),_:1}),t(e(w),{prop:"create_time",label:"创建时间",width:"180",align:"center"},{default:l(a=>[n(C(M(a.row.create_time)),1)]),_:1}),t(e(w),{prop:"update_time",label:"更新时间",width:"180",align:"center"},{default:l(a=>[n(C(M(a.row.update_time)),1)]),_:1}),t(e(w),{label:"操作",width:"260",fixed:"right"},{default:l(a=>[t(e(v),{size:"small",onClick:S=>ae(a.row)},{default:l(()=>[n("设置")]),_:2},1032,["onClick"]),t(e(v),{size:"small",onClick:S=>te(a.row)},{default:l(()=>[n("查看")]),_:2},1032,["onClick"]),t(e(v),{size:"small",type:"primary",onClick:S=>ee(a.row)},{default:l(()=>[n("编辑")]),_:2},1032,["onClick"]),t(e(v),{size:"small",type:"danger",onClick:S=>le(a.row)},{default:l(()=>[n("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[T,x.value]]),z("div",Ie,[t(e(Ve),{"current-page":p.page,"onUpdate:currentPage":s[3]||(s[3]=a=>p.page=a),"page-size":p.limit,"onUpdate:pageSize":s[4]||(s[4]=a=>p.limit=a),"page-sizes":[10,20,50,100],total:p.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:W,onCurrentChange:X},null,8,["current-page","page-size","total"])]),t(e(ke),{modelValue:f.value,"onUpdate:modelValue":s[10]||(s[10]=a=>f.value=a),title:m.value==="add"?"新增问题模板":m.value==="edit"?"编辑问题模板":"查看问题模板",width:"600px","close-on-click-modal":!1},{footer:l(()=>[z("span",je,[t(e(v),{onClick:s[9]||(s[9]=a=>f.value=!1)},{default:l(()=>[n("取消")]),_:1}),m.value!=="view"?(V(),A(e(v),{key:0,type:"primary",loading:k.value,onClick:se},{default:l(()=>[n(" 确认 ")]),_:1},8,["loading"])):ge("",!0)])]),default:l(()=>[t(e(Ce),{ref_key:"formRef",ref:_,model:o,rules:H,"label-width":"100px",disabled:m.value==="view"},{default:l(()=>[t(e(L),{label:"标题",prop:"title"},{default:l(()=>[t(e(F),{modelValue:o.title,"onUpdate:modelValue":s[5]||(s[5]=a=>o.title=a),placeholder:"请输入标题",maxlength:"125","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(e(L),{label:"描述",prop:"description"},{default:l(()=>[t(e(F),{modelValue:o.description,"onUpdate:modelValue":s[6]||(s[6]=a=>o.description=a),type:"textarea",rows:4,placeholder:"请输入描述",maxlength:"2048","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(e(L),{label:"状态",prop:"status"},{default:l(()=>[t(e(xe),{modelValue:o.status,"onUpdate:modelValue":s[7]||(s[7]=a=>o.status=a)},{default:l(()=>[t(e(G),{label:1},{default:l(()=>[n("启用")]),_:1}),t(e(G),{label:0},{default:l(()=>[n("禁用")]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(e(L),{label:"售前代理ID",prop:"sale_agent_id"},{default:l(()=>[t(e($),{modelValue:o.sale_agent_id,"onUpdate:modelValue":s[8]||(s[8]=a=>o.sale_agent_id=a),placeholder:"请选择售前代理",clearable:"",style:{width:"100%"}},{default:l(()=>[(V(!0),j(O,null,P(D.value,a=>(V(),A(e(U),{key:a.value,value:a.value,label:a.label},{default:l(()=>[n(C(a.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["modelValue","title"])])}}}),sa=ve(Qe,[["__scopeId","data-v-5f4fd16f"]]);export{sa as default};
