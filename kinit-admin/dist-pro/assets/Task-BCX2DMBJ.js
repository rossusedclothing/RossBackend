var E=Object.defineProperty;var C=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var D=(l,o,t)=>o in l?E(l,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[o]=t,O=(l,o)=>{for(var t in o||(o={}))F.call(o,t)&&D(l,t,o[t]);if(C)for(var t of C(o))M.call(o,t)&&D(l,t,o[t]);return l};var x=(l,o,t)=>new Promise((u,c)=>{var S=r=>{try{m(t.next(r))}catch(d){c(d)}},w=r=>{try{m(t.throw(r))}catch(d){c(d)}},m=r=>r.done?u(r.value):Promise.resolve(r.value).then(S,w);m((t=t.apply(l,o)).next())});import{u as q,_ as J}from"./Table.vue_vue_type_script_lang-Dze8ZwxX.js";import{d as Z,t as P}from"./index-BSaZkSQ-.js";import{_ as G}from"./Search.vue_vue_type_script_setup_true_lang-D_ZuBLEj.js";import{_ as H}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bhi8rX8m.js";import{_ as K}from"./Detail.vue_vue_type_script_setup_true_lang-CT6W9VAI.js";import{_ as Q}from"./Dialog.vue_vue_type_style_index_0_lang-CkZ5gdNT.js";import{s as W}from"./dict-DJyIMlYA.js";import{u as X}from"./dict-DVpgL_Jf.js";import{l as Y,aB as ee,a as p,Z as V,U as n,F as y,S as $,m as z,p as te,O as b,u as a,B,T as ae,M as oe,R as se}from"./vue-chunks-o2h5QaLn.js";import{g as le}from"./task-tcKAaQII.js";/* empty css                       *//* empty css                 *//* empty css                   */import"./element-plus-BkD8NzPH.js";/* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                      *//* empty css                  *//* empty css                        *//* empty css                */import"./useForm-BREZWcm3.js";/* empty css                     *//* empty css               *//* empty css                          *//* empty css                       *//* empty css                       *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-CeSE9S1A.js";import"./wang-editor-D1s6zAlo.js";/* empty css                   *//* empty css                    *//* empty css                         */import"./_Uint8Array-CsvjRP4S.js";import"./useIcon-CkkjqTSS.js";import"./Descriptions-CwTxbgY0.js";/* empty css              *//* empty css                  */import"./dict-Ua4YypUZ.js";const Qe=Y({name:"SystemRecordTask",__name:"Task",setup(l){const{t:o}=Z(),{currentRoute:t}=ee(),u=t.value.query.job_id,c=p([]);x(this,null,function*(){const e=yield X().getDictObj(["vadmin_system_task_exec_strategy"]);c.value=e.vadmin_system_task_exec_strategy});const{tableRegister:w,tableState:m,tableMethods:r}=q({immediate:!1,fetchDataApi:()=>x(this,null,function*(){const{pageSize:s,currentPage:e}=m,i=yield le(O({page:a(e),limit:a(s)},a(v)));return{list:i.data||[],total:i.count||0}})}),{dataList:d,loading:L,total:N,pageSize:h,currentPage:f}=m,{getList:_}=r,U=V([{field:"job_id",label:"任务编号",show:!0,disabled:!0,width:"240px"},{field:"name",label:"任务名称",show:!0,disabled:!0},{field:"group",label:"任务分组",show:!0,span:2},{field:"job_class",label:"调用目标",show:!0},{field:"exec_strategy",label:"执行策略",show:!0,slots:{default:s=>{const e=s.row;return n(y,null,[n("div",null,[W(c.value,e.exec_strategy)])])}}},{field:"expression",label:"表达式",show:!0,span:24},{field:"start_time",label:"开始执行时间",show:!1,width:"200px"},{field:"end_time",label:"执行完成时间",width:"200px",show:!0},{field:"process_time",label:"耗时(秒)",width:"110px",show:!0},{field:"retval",label:"任务返回值",show:!0,slots:{default:s=>{const e=s.row;return JSON.parse(e.retval)}}},{field:"exception",label:"异常信息",show:!1,span:24},{field:"traceback",label:"堆栈跟踪",show:!1,width:"100px"},{field:"action",width:"100px",label:"操作",show:!0,disabled:!0,slots:{default:s=>{const e=s.row;return n(y,null,[n(P,{type:"primary",link:!0,size:"small",onClick:()=>I(e)},{default:()=>[$("详情")]})])}}}]),A=V([{field:"job_id",label:"任务编号",component:"Input",componentProps:{clearable:!0,style:{width:"240px"}},value:u},{field:"name",label:"任务名称",component:"Input",componentProps:{clearable:!0}}]),v=p({}),k=s=>{f.value=1,v.value=s,_()},g=p(!1),R=p(""),T=p(),j=p(""),I=s=>{R.value=o("exampleDemo.detail"),j.value="detail",T.value=s,g.value=!0};return u&&(v.value={job_id:u}),_(),(s,e)=>(z(),te(y,null,[n(a(H),null,{default:b(()=>[n(a(G),{schema:A,onReset:k,onSearch:k},null,8,["schema"]),n(a(J),{"current-page":a(f),"onUpdate:currentPage":e[0]||(e[0]=i=>B(f)?f.value=i:null),"page-size":a(h),"onUpdate:pageSize":e[1]||(e[1]=i=>B(h)?h.value=i:null),showAction:"",columns:U,"node-key":"id",data:a(d),loading:a(L),pagination:{total:a(N)},onRegister:a(w),onRefresh:a(_)},null,8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])]),_:1}),n(a(Q),{modelValue:g.value,"onUpdate:modelValue":e[3]||(e[3]=i=>g.value=i),title:R.value,width:"800px"},{footer:b(()=>[n(a(P),{onClick:e[2]||(e[2]=i=>g.value=!1)},{default:b(()=>[$(ae(a(o)("dialogDemo.close")),1)]),_:1})]),default:b(()=>[j.value==="detail"?(z(),oe(K,{key:0,"current-row":T.value},null,8,["current-row"])):se("",!0)]),_:1},8,["modelValue","title"])],64))}});export{Qe as default};
