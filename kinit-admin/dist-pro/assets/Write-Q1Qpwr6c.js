var u=(b,c,o)=>new Promise((f,l)=>{var d=t=>{try{r(o.next(t))}catch(i){l(i)}},v=t=>{try{r(o.throw(t))}catch(i){l(i)}},r=t=>t.done?f(t.value):Promise.resolve(t.value).then(d,v);r((o=o.apply(b,c)).next())});import{u as k,F as C}from"./useForm-B5RQKQQi.js";import{u as F}from"./useValidator-UROf_CnT.js";import{f as A,ao as x,Q as D,M as w,K as B,F as E,a as y,h as R,E as V,G as M,u as _}from"./vue-chunks-wbK7PffK.js";import{v as N}from"./index-SAHUQZ2g.js";import{_ as S}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bq-Mkqar.js";import{a as q,b as O,p as T,c as $}from"./issue-jfqE-GDT.js";import{b as a}from"./element-plus-C0vem28W.js";/* empty css                     *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 *//* empty css               *//* empty css                    *//* empty css                 *//* empty css                          *//* empty css                       *//* empty css                       *//* empty css                  *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-BFkgkg1x.js";import"./wang-editor-K_dPeC8b.js";/* empty css                   *//* empty css                    *//* empty css                      *//* empty css                */const ye=A({name:"HelpIssueForm",__name:"Write",setup(b,{expose:c}){const{required:o}=F(),{push:f,currentRoute:l}=x(),d={customAlert:(e,s)=>{switch(s){case"success":a.success(e);break;case"info":a.info(e);break;case"warning":a.warning(e);break;case"error":a.error(e);break;default:a.info(e);break}},autoFocus:!1,scroll:!0,readOnly:!1,uploadImgShowBase64:!0,placeholder:"请输入内容..."},v=D([{field:"title",label:"标题名称",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"}},formItemProps:{rules:[o()]}},{field:"content",label:"内容",colProps:{span:24},component:"Editor",componentProps:{style:{width:"100%"},editorConfig:d,editorId:"issueContent"},formItemProps:{rules:[o()]}},{field:"category_id",label:"问题类别",colProps:{span:24},component:"Select",componentProps:{style:{width:"100%"}},formItemProps:{rules:[o()]},optionApi:()=>u(this,null,function*(){return(yield q()).data})},{field:"",label:"",colProps:{span:24},formItemProps:{slots:{default:()=>w(E,null,[w(N,{loading:m.value,type:"primary",onClick:I},{default:()=>[B("立即保存")]})])}}}]),{formRegister:r,formMethods:t}=k(),{getFormData:i,getElFormExpose:P,setValues:h}=t,p=y(""),m=y(!1);u(this,null,function*(){const e=l.value.query.id;if(e){p.value="edit";const s=yield $(Number(e));s?h(s.data):f("/404")}else p.value="add"});const I=()=>u(this,null,function*(){const e=yield P();if(yield e==null?void 0:e.validate()){m.value=!0;const g=yield i();if(!g)return m.value=!1,a.error("未获取到数据");const n=y();try{p.value==="add"?(n.value=yield O(g),n.value&&(e==null||e.resetFields(),a.success("新增成功"))):p.value==="edit"&&(n.value=yield T(g),n.value&&(h(n.value.data),a.success("更新成功")))}finally{m.value=!1}}});return c({submit:I}),(e,s)=>(R(),V(_(S),null,{default:M(()=>[w(_(C),{onRegister:_(r),schema:v,labelPosition:"top"},null,8,["onRegister","schema"])]),_:1}))}});export{ye as default};
