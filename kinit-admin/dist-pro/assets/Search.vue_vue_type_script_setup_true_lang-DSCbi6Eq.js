var X=Object.defineProperty;var N=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var _=(o,c,a)=>c in o?X(o,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[c]=a,D=(o,c)=>{for(var a in c||(c={}))Y.call(c,a)&&_(o,a,c[a]);if(N)for(var a of N(c))Z.call(c,a)&&_(o,a,c[a]);return o};var g=(o,c,a)=>new Promise((u,h)=>{var p=d=>{try{b(a.next(d))}catch(f){h(f)}},m=d=>{try{b(a.throw(d))}catch(f){h(f)}},b=d=>d.done?u(d.value):Promise.resolve(d.value).then(p,m);b((a=a.apply(o,c)).next())});import{u as ee,i as oe,F as te}from"./useForm-B5RQKQQi.js";import{k as i,d as se,A as T,B as ae,C as ne}from"./index-SAHUQZ2g.js";import{u as L}from"./useIcon-DF_xcSd1.js";import{f as q,a9 as ie,h as w,i as B,E as R,G as V,K as x,L as C,u as n,J as S,F as z,a as v,e as F,M as y,b as le,d as ce,A as re}from"./vue-chunks-wbK7PffK.js";import{c as de,a4 as ue}from"./element-plus-C0vem28W.js";const W=q({__name:"ActionButton",props:{showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),visible:i.bool.def(!0),searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","expand"],setup(o,{emit:c}){const a=c,{t:u}=se(),h=()=>{a("search")},p=()=>{a("reset")},m=()=>{a("expand")};return(b,d)=>{const f=ie("BaseButton");return w(),B(z,null,[o.showSearch?(w(),R(f,{key:0,type:"primary",loading:o.searchLoading,icon:n(L)({icon:"ep:search"}),onClick:h},{default:V(()=>[x(C(n(u)("common.query")),1)]),_:1},8,["loading","icon"])):S("",!0),o.showReset?(w(),R(f,{key:1,loading:o.resetLoading,icon:n(L)({icon:"ep:refresh-right"}),onClick:p},{default:V(()=>[x(C(n(u)("common.reset")),1)]),_:1},8,["loading","icon"])):S("",!0),o.showExpand?(w(),R(f,{key:2,icon:n(L)({icon:o.visible?"ep:arrow-up":"ep:arrow-down"}),text:"",onClick:m},{default:V(()=>[x(C(n(u)(o.visible?"common.shrink":"common.expand")),1)]),_:1},8,["icon"])):S("",!0)],64)}}}),Se=q({__name:"Search",props:{schema:{type:Array,default:()=>[]},isCol:i.bool.def(!1),labelWidth:i.oneOfType([String,Number]).def("auto"),layout:i.string.validate(o=>["inline","bottom"].includes(o)).def("inline"),buttonPosition:i.string.validate(o=>["left","center","right"].includes(o)).def("center"),showSearch:i.bool.def(!0),showReset:i.bool.def(!0),showExpand:i.bool.def(!1),expandField:i.string.def(""),inline:i.bool.def(!0),removeNoValueItem:i.bool.def(!0),model:{type:Object,default:()=>({})},searchLoading:i.bool.def(!1),resetLoading:i.bool.def(!1)},emits:["search","reset","register","validate"],setup(o,{expose:c,emit:a}){const u=o,h=a,p=v(!0),m=v(u.model),b=F(()=>{const e=n(r);let t=de(e.schema);if(e.showExpand&&e.expandField&&!n(p)){const s=T(t,l=>l.field===e.expandField);t.map((l,U)=>(U>=s?l.hidden=!0:l.hidden=!1,l))}return e.layout==="inline"&&(t=t.concat([{field:"action",formItemProps:{labelWidth:"0px",slots:{default:()=>y("div",null,[y(W,{showSearch:e.showSearch,showReset:e.showReset,showExpand:e.showExpand,searchLoading:e.searchLoading,resetLoading:e.resetLoading,visible:p.value,onExpand:I,onReset:A,onSearch:P},null)]),label:()=>y("span",null,[x("Â ")])}}}])),t}),{formRegister:d,formMethods:f}=ee(),{getElFormExpose:k,getFormData:G,getFormExpose:J}=f,K=v({}),E=v({}),r=F(()=>{const e=D({},u);return Object.assign(e,n(E)),e}),$=(e={})=>{E.value=Object.assign(n(E),e),K.value=e},O=v([]);le(()=>n(b),(...t)=>g(this,[...t],function*(e=[]){m.value=oe(e,n(m)),O.value=e}),{immediate:!0,deep:!0});const j=()=>g(this,null,function*(){const e=yield G();return n(r).removeNoValueItem?Object.keys(e).reduce((t,s)=>{const l=e[s];return ae(l)||(ne(l)?Object.keys(l).length>0&&(t[s]=l):t[s]=l),t},{}):e}),P=()=>g(this,null,function*(){const e=yield k();yield e==null?void 0:e.validate(t=>g(this,null,function*(){if(t){const s=yield j();h("search",s)}}))}),A=()=>g(this,null,function*(){const e=yield k();e==null||e.resetFields();const t=yield j();h("reset",t)}),H=F(()=>({textAlign:n(r).buttonPosition})),I=()=>g(this,null,function*(){p.value=!n(p)}),M={getElFormExpose:k,setProps:$,setSchema:e=>{const{schema:t}=n(r);for(const s of t)for(const l of e)s.field===l.field&&ue(s,l.path,l.value)},setValues:(...t)=>g(this,[...t],function*(e={}){m.value=Object.assign(u.model,n(m),e);const s=yield J();s==null||s.setValues(e)}),delSchema:e=>{const{schema:t}=n(r),s=T(t,l=>l.field===e);s>-1&&t.splice(s,1)},addSchema:(e,t)=>{const{schema:s}=n(r);if(t!==void 0){s.splice(t,0,e);return}s.push(e)}};ce(()=>{h("register",M)}),c(M);const Q=(e,t,s)=>{h("validate",e,t,s)};return(e,t)=>(w(),B(z,null,[y(n(te),{model:m.value,"is-custom":!1,"label-width":r.value.labelWidth,"hide-required-asterisk":"",inline:r.value.inline,"is-col":r.value.isCol,schema:O.value,onRegister:n(d),onValidate:Q},null,8,["model","label-width","inline","is-col","schema","onRegister"]),o.layout==="bottom"?(w(),B("div",{key:0,style:re(H.value)},[y(W,{"show-reset":r.value.showReset,"show-search":r.value.showSearch,"show-expand":r.value.showExpand,"search-loading":r.value.searchLoading,"reset-loading":r.value.resetLoading,onExpand:I,onReset:A,onSearch:P},null,8,["show-reset","show-search","show-expand","search-loading","reset-loading"])],4)):S("",!0)],64))}});export{Se as _};
