var Y=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var V=(x,o,i)=>o in x?Y(x,o,{enumerable:!0,configurable:!0,writable:!0,value:i}):x[o]=i,q=(x,o)=>{for(var i in o||(o={}))se.call(o,i)&&V(x,i,o[i]);if(S)for(var i of S(o))ne.call(o,i)&&V(x,i,o[i]);return x},k=(x,o)=>ee(x,te(o));var $=(x,o,i)=>new Promise((m,f)=>{var b=r=>{try{_(i.next(r))}catch(l){f(l)}},v=r=>{try{_(i.throw(r))}catch(l){f(l)}},_=r=>r.done?m(r.value):Promise.resolve(r.value).then(b,v);_((i=i.apply(x,o)).next())});import{a as g,Z as B,d as oe,e as N,m as u,p as a,q as e,S as T,F as p,a7 as y,T as d,R as h,a2 as U,P as A,al as z,aJ as ie}from"./vue-chunks-o2h5QaLn.js";import{g as le,a as ue,p as ae,b as de,d as re,c as ce,e as _e,f as xe}from"./questiong-B6AV4btd.js";import"./index-BSaZkSQ-.js";/* empty css                    */import"./element-plus-BkD8NzPH.js";const ve={class:"min-h-screen bg-gray-50 p-6"},be={class:"max-w-6xl mx-auto"},ge={class:"bg-white rounded-lg shadow-lg p-6"},he={class:"space-y-4"},fe={class:"flex justify-between items-start mb-3"},me={class:"flex-1"},pe={class:"text-lg font-semibold text-gray-800 mb-2"},ye={class:"text-gray-600"},we={class:"flex space-x-2 ml-4"},qe=["onClick"],ke=["onClick"],Ae=["onClick"],Ce={key:0,class:"mt-4 pl-4 border-l-2 border-blue-200"},Qe={class:"flex justify-between items-center mb-3"},Fe=e("h4",{class:"text-md font-medium text-gray-700"},"相关答案",-1),Le=["onClick"],je={class:"space-y-2"},Me={class:"flex justify-between items-start"},Se={class:"flex-1"},Ve={class:"text-gray-800 mb-1"},$e={key:0,class:"text-sm text-blue-600"},Be={class:"flex space-x-2 ml-4"},Ne=["onClick"],Te=["onClick"],Ue={key:0,class:"text-gray-500 text-center py-4"},ze={key:0,class:"text-center py-8 text-gray-500"},De={key:0,class:"mt-8 bg-gray-50 p-4 rounded-lg"},Re=e("h3",{class:"text-lg font-semibold mb-4 text-gray-800"},"问题流程图",-1),Ee={class:"space-y-2"},Je={class:"font-medium text-blue-600"},Pe={class:"ml-4 mt-1"},Ze={key:0,class:"text-green-600"},Ge={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},He={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},Ie={class:"text-xl font-bold mb-4 text-gray-800"},Ke={class:"mb-4"},Oe=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"问题内容",-1),We={class:"flex justify-end space-x-3"},Xe={type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors"},Ye={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},et={class:"bg-white rounded-lg p-6 w-full max-w-md mx-4"},tt={class:"text-xl font-bold mb-4 text-gray-800"},st={class:"mb-4"},nt=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"答案内容",-1),ot={class:"mb-4"},it=e("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"下一个问题（可选）",-1),lt=e("option",{value:""},"无跳转",-1),ut=["value"],at={class:"flex justify-end space-x-3"},dt={type:"submit",class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors"},gt={__name:"Clothing",setup(x){g("服装");const o=g([{id:1,question:"您对我们的产品满意吗？"},{id:2,question:"您希望我们改进哪些方面？"},{id:3,question:"您会推荐给朋友吗？"}]),i=g([{id:1,question_id:1,answer:"非常满意",next_question:3},{id:2,question_id:1,answer:"一般满意",next_question:2},{id:3,question_id:1,answer:"不满意",next_question:2},{id:4,question_id:2,answer:"价格方面",next_question:null},{id:5,question_id:2,answer:"功能方面",next_question:null},{id:6,question_id:3,answer:"会推荐",next_question:null},{id:7,question_id:3,answer:"不会推荐",next_question:null}]),m=g(!1),f=g(!1),b=g(new Set),v=g(null),_=g(null),r=B({question:""}),l=B({question_id:null,answer:"",next_question:""});oe(()=>{C()});const C=()=>$(this,null,function*(){const t=yield le();if(t.code==200&&t.data){o.value=t.data;const n=yield ue();n.code==200&&n.data?i.value=n.data:i.value=[]}else return[]}),D=N(()=>o.value.length>0?Math.max(...o.value.map(t=>t.id))+1:1),R=N(()=>i.value.length>0?Math.max(...i.value.map(t=>t.id))+1:1);function w(t){return i.value.filter(n=>n.question_id===t)}function E(t){return o.value.find(n=>n.id===t)}function J(){F(),m.value=!0}function Q(){m.value=!1,v.value=null,F()}function F(){r.question=""}function P(t){v.value=t,r.question=t.question,m.value=!0}function Z(){v.value?(v.value.question=r.question,ae(v.value).then(t=>{if(t.value){const n=o.value.findIndex(s=>s.id===v.value.id);n!==-1&&(o.value[n]=k(q({},o.value[n]),{question:r.question}))}})):de({question:r.question}).then(t=>{t.value&&o.value.push({id:D.value,question:r.question})}),Q()}function G(t){confirm("确定要删除这个问题吗？删除后相关答案也会被删除。")&&(o.value=o.value.filter(n=>n.id!==t),i.value=i.value.filter(n=>n.question_id!==t),b.value.delete(t),re([t]).then(n=>{}))}function H(t){j(),l.question_id=t,f.value=!0}function L(){f.value=!1,_.value=null,j()}function j(){l.question_id=null,l.answer="",l.next_question=""}function I(t){_.value=t,l.question_id=t.question_id,l.answer=t.answer,l.next_question=t.next_question||"",f.value=!0}function K(){if(_.value)_.value.answer=l.answer,_.value.next_question=l.next_question||null,ce(_.value).then(t=>{if(t.value){const n=i.value.findIndex(s=>s.id===_.value.id);n!==-1&&(i.value[n]=k(q({},i.value[n]),{answer:l.answer,next_question:l.next_question||null}))}});else{const t={question_id:l.question_id,answer:l.answer,next_question:l.next_question||null};_e(t).then(n=>{n.value&&i.value.push({id:R.value,question_id:l.question_id,answer:l.answer,next_question:l.next_question||null})})}L()}function O(t){confirm("确定要删除这个答案吗？")&&xe([t]).then(n=>{n.value&&(i.value=i.value.filter(s=>s.id!==t))})}function W(t){b.value.has(t)?b.value.delete(t):b.value.add(t)}return(t,n)=>(u(),a("div",ve,[e("div",be,[e("div",ge,[e("div",{class:"flex justify-between items-center mb-6"},[e("h1",{class:"text-3xl font-bold text-gray-800"},[T(" 问答配置 "),e("button",{class:"btn",onClick:C},"⭕️")]),e("button",{onClick:J,class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors"}," 新增问题 ")]),e("div",he,[(u(!0),a(p,null,y(o.value,s=>(u(),a("div",{key:s.id,class:"border border-gray-200 rounded-lg p-4"},[e("div",fe,[e("div",me,[e("h3",pe," 问题 #"+d(s.id)+" "+d(s.question),1),e("p",ye,d(s.question),1)]),e("div",we,[e("button",{onClick:c=>P(s),class:"text-blue-500 hover:text-blue-700 px-3 py-1 rounded"}," 编辑 ",8,qe),e("button",{onClick:c=>G(s.id),class:"text-red-500 hover:text-red-700 px-3 py-1 rounded"}," 删除 ",8,ke),e("button",{onClick:c=>W(s.id),class:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded transition-colors"},d(b.value.has(s.id)?"收起答案":"查看答案"),9,Ae)])]),b.value.has(s.id)?(u(),a("div",Ce,[e("div",Qe,[Fe,e("button",{onClick:c=>H(s.id),class:"bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm transition-colors"}," 新增答案 ",8,Le)]),e("div",je,[(u(!0),a(p,null,y(w(s.id),c=>{var M;return u(),a("div",{key:c.id,class:"bg-gray-50 p-3 rounded border"},[e("div",Me,[e("div",Se,[e("p",Ve,d(c.answer),1),c.next_question?(u(),a("p",$e," → 跳转到问题 #"+d(c.next_question)+": "+d((M=E(c.next_question))==null?void 0:M.question),1)):h("",!0)]),e("div",Be,[e("button",{onClick:X=>I(c),class:"text-blue-500 hover:text-blue-700 text-sm px-2 py-1 rounded"}," 编辑 ",8,Ne),e("button",{onClick:X=>O(c.id),class:"text-red-500 hover:text-red-700 text-sm px-2 py-1 rounded"}," 删除 ",8,Te)])])])}),128)),w(s.id).length===0?(u(),a("div",Ue," 暂无答案 ")):h("",!0)])])):h("",!0)]))),128)),o.value.length===0?(u(),a("div",ze," 暂无问题，点击上方按钮添加第一个问题 ")):h("",!0)]),o.value.length>0?(u(),a("div",De,[Re,e("div",Ee,[(u(!0),a(p,null,y(o.value,s=>(u(),a("div",{key:s.id,class:"text-sm"},[e("span",Je,"问题 #"+d(s.id)+" "+d(s.question),1),e("div",Pe,[(u(!0),a(p,null,y(w(s.id),c=>(u(),a("div",{key:c.id,class:"text-gray-600"},[T(' "'+d(c.answer)+'" ',1),c.next_question?(u(),a("span",Ze," → 问题 #"+d(c.next_question),1)):h("",!0)]))),128))])]))),128))])])):h("",!0)])]),m.value?(u(),a("div",Ge,[e("div",He,[e("h2",Ie,d(v.value?"编辑问题":"新增问题"),1),e("form",{onSubmit:U(Z,["prevent"])},[e("div",Ke,[Oe,A(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=s=>r.question=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"4",placeholder:"请输入问题内容...",required:""},null,512),[[z,r.question]])]),e("div",We,[e("button",{type:"button",onClick:Q,class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),e("button",Xe,d(v.value?"更新":"保存"),1)])],32)])])):h("",!0),f.value?(u(),a("div",Ye,[e("div",et,[e("h2",tt,d(_.value?"编辑答案":"新增答案"),1),e("form",{onSubmit:U(K,["prevent"])},[e("div",st,[nt,A(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=s=>l.answer=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:"3",placeholder:"请输入答案内容...",required:""},null,512),[[z,l.answer]])]),e("div",ot,[it,A(e("select",{"onUpdate:modelValue":n[2]||(n[2]=s=>l.next_question=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"},[lt,(u(!0),a(p,null,y(o.value,s=>(u(),a("option",{key:s.id,value:s.id}," 问题 #"+d(s.id)+": "+d(s.question.substring(0,50))+d(s.question.length>50?"...":""),9,ut))),128))],512),[[ie,l.next_question]])]),e("div",at,[e("button",{type:"button",onClick:L,class:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors"}," 取消 "),e("button",dt,d(_.value?"更新":"保存"),1)])],32)])])):h("",!0)]))}};export{gt as default};
