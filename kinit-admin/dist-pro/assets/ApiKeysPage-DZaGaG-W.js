var P=Object.defineProperty;var B=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var D=(u,n,t)=>n in u?P(u,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[n]=t,x=(u,n)=>{for(var t in n||(n={}))q.call(n,t)&&D(u,t,n[t]);if(B)for(var t of B(n))H.call(n,t)&&D(u,t,n[t]);return u};var f=(u,n,t)=>new Promise((v,r)=>{var _=o=>{try{d(t.next(o))}catch(k){r(k)}},b=o=>{try{d(t.throw(o))}catch(k){r(k)}},d=o=>o.done?v(o.value):Promise.resolve(o.value).then(_,b);d((t=t.apply(u,n)).next())});import{l as R,a as y,Z as C,d as G,m as U,p as j,q as K,U as l,a8 as J,u as e,O as i,S as m,F as Z,a7 as Q,M as W}from"./vue-chunks-o2h5QaLn.js";import{_ as X}from"./index-BSaZkSQ-.js";/* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                      *//* empty css                  *//* empty css                       */import{g as Y,a as I,u as ee,b as ae,d as le}from"./panel-DIAGtAHY.js";import{D as w,d as c,t as g,u as te,v as oe,B as se,C as E,F as pe,G as ne,H as ie,w as O,b as z}from"./element-plus-BkD8NzPH.js";const ue={class:"p-4"},re={class:"flex items-center justify-between mb-4"},de={class:"flex items-center gap-2"},me={class:"mt-4 flex justify-end"},ce=R({__name:"ApiKeysPage",setup(u){const n=y([]),t=C({page:1,limit:10,total:0,v_order:"desc"}),v=C({platform:""}),r=y(!1),_=y("新建 ApiKey"),b=y(!1),d=y(null),o=C({platform:"",key_value:"",useapp_name:"",desc:""}),k=C([{label:"openai",value:"openai"},{label:"deepseek",value:"deepseek"},{label:"智普清言",value:"智普清言"},{label:"siliconflow",value:"siliconflow"},{label:"google",value:"google"},{label:"tongyi",value:"tongyi"},{label:"coze",value:"coze"},{label:"huosan",value:"huosan"},{label:"other",value:"other"}]),S=y(),V=()=>f(this,null,function*(){const p=x(x({},t),v),a=yield Y(p);a&&a.data&&(a.data,n.value=a.data||[],t.total=a.data.total||n.value.length),n.value});G(V);const h=()=>{t.page=1,V()},F=p=>{t.page=p,V()},M=()=>{b.value=!1,d.value=null,_.value="新建 ApiKey",Object.assign(o,{platform:"",key_value:"",useapp_name:"",desc:""}),r.value=!0},T=p=>f(this,null,function*(){b.value=!0,d.value=p.id,_.value="编辑 ApiKey";const a=yield I(p.id);a&&a.data?Object.assign(o,a.data):Object.assign(o,{platform:p.platform,key_value:p.key_value,useapp_name:p.useapp_name,desc:p.desc}),r.value=!0}),$=p=>f(this,null,function*(){const a=yield I(p.id);O.alert(JSON.stringify(a.data||p,null,2),"ApiKey 详情",{dangerouslyUseHTMLString:!1})}),L=()=>f(this,null,function*(){try{yield b.value?ee(d.value,o):ae(o),z({message:"保存成功",type:"success"}),r.value=!1,V()}catch(p){z({message:"保存失败",type:"error"})}}),N=p=>{O.confirm(`确认删除 ID=${p.id} ?`,"删除确认",{type:"warning"}).then(()=>f(this,null,function*(){yield le([p.id]),z({message:"删除成功",type:"success"}),V()})).catch(()=>{})};return(p,a)=>(U(),j("div",ue,[K("div",re,[K("div",de,[l(e(w),{modelValue:v.platform,"onUpdate:modelValue":a[0]||(a[0]=s=>v.platform=s),placeholder:"平台名称 / key / app 名称",clearable:"",onClear:h,onKeyup:J(h,["enter"])},null,8,["modelValue"]),l(e(c),{onClick:h,type:"primary",plain:""},{default:i(()=>[m("搜索")]),_:1})]),K("div",null,[l(e(c),{onClick:M,type:"primary"},{default:i(()=>[m("新建 ApiKey")]),_:1})])]),l(e(te),{data:n.value,stripe:"",style:{width:"100%"}},{default:i(()=>[l(e(g),{prop:"id",label:"ID",width:"80"}),l(e(g),{prop:"platform",label:"平台"}),l(e(g),{prop:"key_value",label:"Key"}),l(e(g),{prop:"useapp_name",label:"所属 App"}),l(e(g),{prop:"desc",label:"描述"}),l(e(g),{label:"操作",width:"220"},{default:i(s=>[l(e(c),{size:"small",onClick:A=>$(s.row)},{default:i(()=>[m("查看")]),_:2},1032,["onClick"]),l(e(c),{size:"small",type:"primary",onClick:A=>T(s.row)},{default:i(()=>[m("编辑")]),_:2},1032,["onClick"]),l(e(c),{size:"small",type:"danger",onClick:A=>N(s.row)},{default:i(()=>[m("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),K("div",me,[l(e(oe),{"current-page":t.page,"page-size":t.limit,total:t.total,layout:"prev, pager, next, jumper, ->, total",onCurrentChange:F},null,8,["current-page","page-size","total"])]),l(e(ie),{title:_.value,modelValue:r.value,"onUpdate:modelValue":a[6]||(a[6]=s=>r.value=s),width:"520px"},{footer:i(()=>[l(e(c),{onClick:a[5]||(a[5]=s=>r.value=!1)},{default:i(()=>[m("取消")]),_:1}),l(e(c),{type:"primary",onClick:L},{default:i(()=>[m("保存")]),_:1})]),default:i(()=>[l(e(se),{model:o,ref_key:"formRef",ref:S,"label-width":"100px"},{default:i(()=>[l(e(E),{label:"平台",prop:"platform",rules:[{required:!0,message:"请输入平台",trigger:"blur"}]},{default:i(()=>[l(e(pe),{modelValue:o.platform,"onUpdate:modelValue":a[1]||(a[1]=s=>o.platform=s),placeholder:"选择平台"},{default:i(()=>[(U(!0),j(Z,null,Q(k,(s,A)=>(U(),W(e(ne),{key:A,label:s.label,value:s.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(e(E),{label:"Key",prop:"key_value",rules:[{required:!0,message:"请输入 key",trigger:"blur"}]},{default:i(()=>[l(e(w),{modelValue:o.key_value,"onUpdate:modelValue":a[2]||(a[2]=s=>o.key_value=s)},null,8,["modelValue"])]),_:1}),l(e(E),{label:"App 名称",prop:"useapp_name"},{default:i(()=>[l(e(w),{modelValue:o.useapp_name,"onUpdate:modelValue":a[3]||(a[3]=s=>o.useapp_name=s)},null,8,["modelValue"])]),_:1}),l(e(E),{label:"描述",prop:"desc"},{default:i(()=>[l(e(w),{modelValue:o.desc,"onUpdate:modelValue":a[4]||(a[4]=s=>o.desc=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])]))}}),ze=X(ce,[["__scopeId","data-v-a8dd102a"]]);export{ze as default};
