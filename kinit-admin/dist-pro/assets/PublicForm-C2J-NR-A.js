var ne=Object.defineProperty,ie=Object.defineProperties;var ue=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable;var A=(d,u,n)=>u in d?ne(d,u,{enumerable:!0,configurable:!0,writable:!0,value:n}):d[u]=n,T=(d,u)=>{for(var n in u||(u={}))de.call(u,n)&&A(d,n,u[n]);if(j)for(var n of j(u))ce.call(u,n)&&A(d,n,u[n]);return d},L=(d,u)=>ie(d,ue(u));var N=(d,u,n)=>new Promise((w,b)=>{var V=f=>{try{x(n.next(f))}catch(q){b(q)}},_=f=>{try{x(n.throw(f))}catch(q){b(q)}},x=f=>f.done?w(f.value):Promise.resolve(f.value).then(V,_);x((n=n.apply(d,u)).next())});import{f as me,ao as pe,a as y,e as _e,Q as fe,d as ge,a9 as p,h as O,i as Q,j as r,L as U,M as e,G as l,K as h,u as C,W,J as be,au as ve,av as he}from"./vue-chunks-wbK7PffK.js";import{q as xe,_ as ye}from"./index-SAHUQZ2g.js";/* empty css                       *//* empty css                 *//* empty css                   */import{b as g,x as G,y as J,z as we,A as Ve,w as K}from"./element-plus-C0vem28W.js";import{a as ke,u as ze,c as Ue}from"./list-C-9kdBUz.js";const F=d=>(ve("data-v-a4fceb48"),d=d(),he(),d),Ce={class:"public-form-container"},qe={class:"form-header"},Be={class:"header-content"},Ne={class:"form-title"},Fe={class:"form-description"},Se={class:"form-content"},Ie=F(()=>r("span",{class:"section-title"},"基本信息",-1)),Te=F(()=>r("span",{class:"section-title"},"业务信息",-1)),De=F(()=>r("span",{class:"section-title"},"外贸信息",-1)),Me=F(()=>r("span",{class:"section-title"},"学员信息",-1)),Pe={class:"submit-section"},Re={class:"form-footer"},Ee={class:"footer-content"},$e=F(()=>r("p",null,[h(" 如有问题，请点击联系我们："),r("a",{href:"mailto:2457676371@qq.com?subject=问题反馈&body=您好，我遇到的问题是：",style:{color:"#1890ff","text-decoration":"underline",cursor:"pointer"}},"发邮件")],-1)),je={class:"footer-links"},Ae={key:0,class:"share-menu"},Le={class:"success-content"},Oe={class:"success-message"},Qe=me({__name:"PublicForm",setup(d){const u=pe(),n=y(!1),w=y(),b=y(!1),V=y(!1),_=y(!1),x=y(null),f=y({}),q=xe(),S=_e(()=>q.user),H=()=>{const a=new URLSearchParams(window.location.search),t=a.get("id"),i=a.get("bt");return{id:t,bt:i}},X=()=>{var t;const a=`${window.location.origin}/businessform/publicform2`;return(t=S.value)!=null&&t.id?`${a}?bt=${S.value.id}`:a},D=a=>{if(!a)return!1;const t=Number(a);return!(isNaN(t)||!Number.isInteger(t)||t<=0)},o=fe({name:"",position:"",region:"",factory_spec:"",product:"",website:"",has_export_experience:!1,export_market:"",student_identity:"",num_members_tradeteam:0,company_size:"",bt:""}),Y={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:50,message:"姓名长度在 2 到 50 个字符",trigger:"blur"}],position:[{required:!1,message:"请输入职位",trigger:"blur"},{max:50,message:"职位长度不能超过 50 个字符",trigger:"blur"}],region:[{required:!0,message:"请输入地区",trigger:"blur"},{max:100,message:"地区长度不能超过 100 个字符",trigger:"blur"}],factory_spec:[{required:!1,message:"请输入工厂规格",trigger:"blur"},{max:200,message:"工厂规格长度不能超过 200 个字符",trigger:"blur"}],product:[{required:!0,message:"请输入主营产品",trigger:"blur"},{max:100,message:"产品名称长度不能超过 100 个字符",trigger:"blur"}],website:[{required:!1,message:"请输入网站链接",trigger:"blur"},{max:200,message:"网站链接长度不能超过 200 个字符",trigger:"blur"}],export_market:[{required:!1,message:"请输入出口市场",trigger:"blur"},{max:200,message:"出口市场描述长度不能超过 200 个字符",trigger:"blur"}],student_identity:[{required:!1,message:"请选择学员身份",trigger:"change"}],company_size:[{required:!1,message:"请选择公司规模",trigger:"change"}]},Z=a=>N(this,null,function*(){try{b.value=!0;const t=yield ke(a);t.code===200&&t.data?(Object.keys(o).forEach(i=>{i in t.data&&(o[i]=t.data[i])}),f.value=T({},t.data)):g.error("获取记录失败")}catch(t){console.error("加载记录失败:",t),g.error("加载记录失败")}finally{b.value=!1}});ge(()=>N(this,null,function*(){var i;const{id:a,bt:t}=H();if(document.title=a?"编辑客户信息":"客户信息登记表",a){const m=Number(a);!isNaN(m)&&m>0?(_.value=!0,x.value=m,yield Z(m)):g.error("无效的记录ID")}t?D(t)?o.bt=t:(g.error("分享链接参数错误，请联系分享人获取正确的链接"),console.error("无效的bt参数:",t)):(i=S.value)!=null&&i.id&&(o.bt=S.value.id.toString())}));const ee=()=>N(this,null,function*(){var a,t;if(w.value)try{if(!(yield w.value.validate()))return;if(o.bt&&!D(o.bt)){g.error("分享链接参数错误，请联系分享人获取正确的链接");return}b.value=!0;const m=L(T({},o),{bt:o.bt||null});let c;_.value&&x.value?c=yield ze(x.value,m):c=yield Ue(m),c.code===200?V.value=!0:g.error(c.message||(_.value?"更新失败，请重试":"提交失败，请重试"))}catch(i){console.error("操作失败:",i),(t=(a=i.response)==null?void 0:a.data)!=null&&t.detail?g.error(`操作失败: ${i.response.data.detail}`):g.error("网络错误，请检查网络连接后重试")}finally{b.value=!1}}),M=()=>{_.value&&f.value?K.confirm("确定要恢复原始数据吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object.keys(o).forEach(a=>{a in f.value&&(o[a]=f.value[a])}),g.success("已恢复原始数据")}):K.confirm("确定要清空所有已填写的内容吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{var t;const a=o.bt;(t=w.value)==null||t.resetFields(),o.num_members_tradeteam=0,o.has_export_experience=!1,o.bt=a,g.success("表单已重置")})},te=()=>{V.value=!1,_.value?u.push("/businessform/list"):(M(),window.scrollTo({top:0,behavior:"smooth"}))},P=()=>{u.push("/businessform/qrcode")},R=()=>N(this,null,function*(){let a=X();try{yield navigator.clipboard.writeText(a),g.success("表单链接已复制到剪贴板")}catch(t){g.error("复制失败，请手动复制链接")}});return(a,t)=>{const i=p("el-divider"),m=p("el-input"),c=p("el-form-item"),k=p("el-col"),I=p("el-row"),v=p("el-option"),E=p("el-select"),$=p("el-radio"),le=p("el-radio-group"),oe=p("el-input-number"),ae=p("el-form"),B=p("el-button"),se=p("el-card"),z=p("el-icon"),re=p("el-dialog");return O(),Q("div",Ce,[r("div",qe,[r("div",Be,[r("h1",Ne,U(_.value?"编辑客户信息":"客户信息登记表"),1),r("p",Fe,U(_.value?"修改客户信息":"欢迎填写客户信息，我们将尽快与您联系"),1)])]),r("div",Se,[e(se,{class:"form-card",shadow:"hover"},{default:l(()=>[e(ae,{ref_key:"formRef",ref:w,model:o,rules:Y,"label-width":"120px","label-position":"left"},{default:l(()=>[e(i,{"content-position":"left"},{default:l(()=>[Ie]),_:1}),e(I,{gutter:20},{default:l(()=>[e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"姓名",prop:"name"},{default:l(()=>[e(m,{modelValue:o.name,"onUpdate:modelValue":t[0]||(t[0]=s=>o.name=s),placeholder:"请输入您的姓名",maxlength:"50",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"职位",prop:"position"},{default:l(()=>[e(m,{modelValue:o.position,"onUpdate:modelValue":t[1]||(t[1]=s=>o.position=s),placeholder:"请输入您的职位",maxlength:"50",size:"large"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(I,{gutter:20},{default:l(()=>[e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"地区",prop:"region"},{default:l(()=>[e(m,{modelValue:o.region,"onUpdate:modelValue":t[2]||(t[2]=s=>o.region=s),placeholder:"请输入所在地区",maxlength:"100",size:"large"},null,8,["modelValue"])]),_:1})]),_:1}),e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"公司规模",prop:"company_size"},{default:l(()=>[e(E,{modelValue:o.company_size,"onUpdate:modelValue":t[3]||(t[3]=s=>o.company_size=s),placeholder:"请选择公司规模",size:"large",style:{width:"100%"}},{default:l(()=>[e(v,{label:"1-10人",value:"1-10人"}),e(v,{label:"11-50人",value:"11-50人"}),e(v,{label:"51-200人",value:"51-200人"}),e(v,{label:"201-500人",value:"201-500人"}),e(v,{label:"500人以上",value:"500人以上"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(i,{"content-position":"left"},{default:l(()=>[Te]),_:1}),e(c,{label:"工厂规格",prop:"factory_spec"},{default:l(()=>[e(m,{modelValue:o.factory_spec,"onUpdate:modelValue":t[4]||(t[4]=s=>o.factory_spec=s),placeholder:"请描述工厂规模、设备等情况",type:"textarea",rows:3,maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(c,{label:"主营产品",prop:"product"},{default:l(()=>[e(m,{modelValue:o.product,"onUpdate:modelValue":t[5]||(t[5]=s=>o.product=s),placeholder:"请输入公司主营产品",maxlength:"100",size:"large"},null,8,["modelValue"])]),_:1}),e(c,{label:"网站链接"},{default:l(()=>[e(m,{modelValue:o.website,"onUpdate:modelValue":t[6]||(t[6]=s=>o.website=s),placeholder:"请输入公司官网或产品链接（可选）",maxlength:"200",size:"large"},null,8,["modelValue"])]),_:1}),e(i,{"content-position":"left"},{default:l(()=>[De]),_:1}),e(I,{gutter:20},{default:l(()=>[e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"外贸经验",prop:"has_export_experience"},{default:l(()=>[e(le,{modelValue:o.has_export_experience,"onUpdate:modelValue":t[7]||(t[7]=s=>o.has_export_experience=s),size:"large"},{default:l(()=>[e($,{label:!0},{default:l(()=>[h("有外贸经验")]),_:1}),e($,{label:!1},{default:l(()=>[h("无外贸经验")]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(k,{xs:24,sm:12},{default:l(()=>[e(c,{label:"外贸团队人数",prop:"num_members_tradeteam"},{default:l(()=>[e(oe,{modelValue:o.num_members_tradeteam,"onUpdate:modelValue":t[8]||(t[8]=s=>o.num_members_tradeteam=s),min:0,max:1e3,placeholder:"0",size:"large","controls-position":"right",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(c,{label:"产品出口市场",prop:"export_market"},{default:l(()=>[e(m,{modelValue:o.export_market,"onUpdate:modelValue":t[9]||(t[9]=s=>o.export_market=s),placeholder:"请输入产品主要出口的国家或地区",type:"textarea",rows:3,maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(i,{"content-position":"left"},{default:l(()=>[Me]),_:1}),e(c,{label:"学员身份",prop:"student_identity"},{default:l(()=>[e(E,{modelValue:o.student_identity,"onUpdate:modelValue":t[10]||(t[10]=s=>o.student_identity=s),placeholder:"请选择学员身份",size:"large",style:{width:"100%"}},{default:l(()=>[e(v,{label:"新学员",value:"新学员"}),e(v,{label:"在读学员",value:"在读学员"}),e(v,{label:"毕业学员",value:"毕业学员"}),e(v,{label:"意向学员",value:"意向学员"}),e(v,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),r("div",Pe,[e(B,{type:"primary",onClick:ee,loading:b.value,size:"large",class:"submit-btn"},{default:l(()=>[h(U(b.value?"提交中...":_.value?"更新信息":"立即提交"),1)]),_:1},8,["loading"]),e(B,{onClick:M,disabled:b.value,size:"large",class:"reset-btn"},{default:l(()=>[h(U(_.value?"恢复原值":"重新填写"),1)]),_:1},8,["disabled"])])]),_:1})]),r("div",Re,[r("div",Ee,[$e,r("div",je,[e(B,{link:"",type:"primary",onClick:P,class:"qrcode-link"},{default:l(()=>[e(z,null,{default:l(()=>[e(C(G))]),_:1}),h(" 生成分享二维码 ")]),_:1}),e(i,{direction:"vertical"}),e(B,{link:"",type:"info",onClick:R},{default:l(()=>[e(z,null,{default:l(()=>[e(C(J))]),_:1}),h(" 复制表单链接 ")]),_:1})])])]),r("div",{class:"floating-share-btn",onClick:t[11]||(t[11]=s=>n.value=!n.value)},[e(z,{size:"20"},{default:l(()=>[e(C(G))]),_:1}),n.value?(O(),Q("div",Ae,[r("div",{class:"share-item",onClick:W(P,["stop"]),style:{color:"black"}},[e(z,null,{default:l(()=>[e(C(we))]),_:1}),h(" 生成二维码 ")]),r("div",{class:"share-item",onClick:W(R,["stop"]),style:{color:"black"}},[e(z,null,{default:l(()=>[e(C(J))]),_:1}),h(" 复制链接 ")])])):be("",!0)]),e(re,{modelValue:V.value,"onUpdate:modelValue":t[12]||(t[12]=s=>V.value=s),title:_.value?"更新成功":"提交成功",width:"400px","show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},{footer:l(()=>[e(B,{type:"primary",onClick:te,size:"large"},{default:l(()=>[h(U(_.value?"返回列表":"继续填写新表单"),1)]),_:1})]),default:l(()=>[r("div",Le,[e(z,{color:"#67C23A",size:"48"},{default:l(()=>[e(C(Ve))]),_:1}),r("p",Oe,U(_.value?"信息更新成功！":"感谢您的提交！我们会在24小时内与您联系。"),1)])]),_:1},8,["modelValue","title"])])}}}),et=ye(Qe,[["__scopeId","data-v-a4fceb48"]]);export{et as default};
