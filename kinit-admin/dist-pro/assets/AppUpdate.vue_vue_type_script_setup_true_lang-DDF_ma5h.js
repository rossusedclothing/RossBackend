var $=Object.defineProperty;var h=Object.getOwnPropertySymbols;var J=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var z=(d,s,l)=>s in d?$(d,s,{enumerable:!0,configurable:!0,writable:!0,value:l}):d[s]=l,E=(d,s)=>{for(var l in s||(s={}))J.call(s,l)&&z(d,l,s[l]);if(h)for(var l of h(s))M.call(s,l)&&z(d,l,s[l]);return d};var y=(d,s,l)=>new Promise((v,u)=>{var g=t=>{try{m(l.next(t))}catch(r){u(r)}},_=t=>{try{m(l.throw(t))}catch(r){u(r)}},m=t=>t.done?v(t.value):Promise.resolve(t.value).then(g,_);m((l=l.apply(d,s)).next())});import{l as P,a as V,Z as U,d as F,m as K,p as q,q as w,U as e,a8 as H,u as a,O as i,S as c}from"./vue-chunks-o2h5QaLn.js";import"./index-BSaZkSQ-.js";/* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                      *//* empty css                  *//* empty css                       */import{c as L,e as Z,f as G,h as Q,i as R}from"./panel-DIAGtAHY.js";import{D as b,d as f,t as C,u as W,v as X,B as Y,C as A,H as ee,w as B,b as k}from"./element-plus-BkD8NzPH.js";const ae={class:"p-4"},le={class:"flex justify-between mb-4"},te={class:"mt-4 flex justify-end"},be=P({__name:"AppUpdate",setup(d){const s=V([]),l=U({page:1,limit:10,total:0,v_order:"desc"}),v=U({app_name:""}),u=V(!1),g=V("新增更新"),_=V(!1),m=V(null),t=U({app_name:"",version:"",update_json:"",desc:""}),r=()=>y(this,null,function*(){const p=yield L(E(E({},l),v));p!=null&&p.data&&(s.value=p.data||[],l.total=p.data.total||s.value.length)});F(r);const x=()=>{l.page=1,r()},D=p=>{l.page=p,r()},N=()=>{_.value=!1,m.value=null,g.value="新增更新",Object.assign(t,{app_name:"",version:"",update_json:"",desc:""}),u.value=!0},O=p=>y(this,null,function*(){_.value=!0,m.value=p.id,g.value="编辑更新";const o=yield Z(p.id);o!=null&&o.data&&Object.assign(t,o.data),u.value=!0}),S=p=>{B.alert(JSON.stringify(p,null,2),"详情")},I=()=>y(this,null,function*(){try{yield _.value?G(m.value,t):Q(t),k({message:"保存成功",type:"success"}),u.value=!1,r()}catch(p){k({message:"保存失败",type:"error"})}}),T=p=>{B.confirm("确认删除？","提示").then(()=>y(this,null,function*(){yield R([p.id]),k({message:"删除成功",type:"success"}),r()})).catch(()=>{})};return(p,o)=>(K(),q("div",ae,[w("div",le,[w("div",null,[e(a(b),{modelValue:v.app_name,"onUpdate:modelValue":o[0]||(o[0]=n=>v.app_name=n),placeholder:"搜索 app 名称",clearable:"",onKeyup:H(x,["enter"])},null,8,["modelValue"]),e(a(f),{onClick:x,type:"primary",plain:""},{default:i(()=>[c("搜索")]),_:1})]),w("div",null,[e(a(f),{type:"primary",onClick:N},{default:i(()=>[c("新增更新")]),_:1})])]),e(a(W),{data:s.value,stripe:""},{default:i(()=>[e(a(C),{prop:"id",label:"ID",width:"80"}),e(a(C),{prop:"app_name",label:"App 名称"}),e(a(C),{prop:"version",label:"版本"}),e(a(C),{prop:"desc",label:"描述"}),e(a(C),{label:"操作",width:"240"},{default:i(n=>[e(a(f),{size:"small",onClick:j=>S(n.row)},{default:i(()=>[c("查看")]),_:2},1032,["onClick"]),e(a(f),{size:"small",type:"primary",onClick:j=>O(n.row)},{default:i(()=>[c("编辑")]),_:2},1032,["onClick"]),e(a(f),{size:"small",type:"danger",onClick:j=>T(n.row)},{default:i(()=>[c("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),w("div",te,[e(a(X),{"current-page":l.page,"page-size":l.limit,total:l.total,layout:"prev, pager, next",onCurrentChange:D},null,8,["current-page","page-size","total"])]),e(a(ee),{title:g.value,modelValue:u.value,"onUpdate:modelValue":o[6]||(o[6]=n=>u.value=n),width:"700px"},{footer:i(()=>[e(a(f),{onClick:o[5]||(o[5]=n=>u.value=!1)},{default:i(()=>[c("取消")]),_:1}),e(a(f),{type:"primary",onClick:I},{default:i(()=>[c("保存")]),_:1})]),default:i(()=>[e(a(Y),{model:t},{default:i(()=>[e(a(A),{label:"App 名称"},{default:i(()=>[e(a(b),{modelValue:t.app_name,"onUpdate:modelValue":o[1]||(o[1]=n=>t.app_name=n)},null,8,["modelValue"])]),_:1}),e(a(A),{label:"版本"},{default:i(()=>[e(a(b),{modelValue:t.version,"onUpdate:modelValue":o[2]||(o[2]=n=>t.version=n)},null,8,["modelValue"])]),_:1}),e(a(A),{label:"更新 JSON"},{default:i(()=>[e(a(b),{type:"textarea",rows:8,modelValue:t.update_json,"onUpdate:modelValue":o[3]||(o[3]=n=>t.update_json=n),placeholder:"放入 JSON 字符串或结构"},null,8,["modelValue"])]),_:1}),e(a(A),{label:"描述"},{default:i(()=>[e(a(b),{autosize:"",rows:5,type:"textarea",placeholder:"Please input",modelValue:t.desc,"onUpdate:modelValue":o[4]||(o[4]=n=>t.desc=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])]))}});export{be as _};
