var P=Object.defineProperty;var B=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var L=(m,o,n)=>o in m?P(m,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):m[o]=n,I=(m,o)=>{for(var n in o||(o={}))R.call(o,n)&&L(m,n,o[n]);if(B)for(var n of B(o))G.call(o,n)&&L(m,n,o[n]);return m};var x=(m,o,n)=>new Promise((k,g)=>{var V=s=>{try{C(n.next(s))}catch(d){g(d)}},z=s=>{try{C(n.throw(s))}catch(d){g(d)}},C=s=>s.done?k(s.value):Promise.resolve(s.value).then(V,z);C((n=n.apply(m,o)).next())});import{f as H,Q as y,a as M,d as J,h as Q,i as X,j as c,M as t,a0 as Y,u as a,G as p,K as f,L as E,au as Z,av as ee}from"./vue-chunks-wbK7PffK.js";import{_ as te}from"./index-SAHUQZ2g.js";/* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css               *//* empty css                      *//* empty css                 *//* empty css                  *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                       */import{n as ae,o as le,p as oe,q as ie,r as se}from"./customer-CdxaMlq0.js";import{D as b,d as _,t as h,u as ne,v as de,H as N,B as re,C as S,b as w,w as pe}from"./element-plus-C0vem28W.js";const A=m=>(Z("data-v-de3da5d6"),m=m(),ee(),m),ue={class:"p-4"},me={class:"flex items-center justify-between mb-4"},ce={class:"flex items-center space-x-2"},fe={class:"text-sm text-gray-500"},ge={class:"mt-4 flex justify-end"},ve={class:"space-y-3"},_e=A(()=>c("strong",null,"名称：",-1)),be=A(()=>c("strong",null,"手机号：",-1)),ye=A(()=>c("div",null,[c("strong",null,"描述：")],-1)),he=A(()=>c("div",null,[c("strong",null,"配置：")],-1)),we=H({__name:"SalesAgentWorkflow",setup(m){const o=y({page:1,limit:10,total:0,v_order:"desc"}),n=M([]),k=y({keyword:""}),g=()=>x(this,null,function*(){var e;const l={page:o.page,limit:o.limit,keyword:k.keyword,v_order:o.v_order};try{const u=yield ae(l);u&&u.data?(n.value=u.data||[],o.total=(e=u.data.total)!=null?e:0):(n.value=[],o.total=0)}catch(u){console.error(u),w.error("获取流程列表失败")}}),V=()=>{o.page=1,g()},z=l=>{o.page=l,g()},C=l=>{o.limit=l,o.page=1,g()},s=y({visible:!1,data:null}),d=y({visible:!1,isEdit:!1,data_id:0}),D=M(),r=y({name:"",phone:"",description:"",config:""}),$=y({name:[{required:!0,message:"请输入名称",trigger:"blur"}]}),j=l=>{l!=null&&l.id?le(l.id).then(e=>{var u;s.data=(u=e==null?void 0:e.data)!=null?u:l,s.visible=!0}).catch(()=>{s.data=l,s.visible=!0}):(s.data=l,s.visible=!0)},F=l=>{var e,u,i,v;d.isEdit=!0,d.data_id=l.id,r.name=(e=l.name)!=null?e:"",r.phone=(u=l.phone)!=null?u:"",r.description=(i=l.description)!=null?i:"",r.config=(v=l.config)!=null?v:"",d.visible=!0},K=()=>{d.isEdit=!1,d.data_id=0,r.name="",r.phone="",r.description="",r.config="",d.visible=!0},T=()=>{d.visible=!1},q=()=>{var l,e;(e=(l=D.value)==null?void 0:l.validate)==null||e.call(l,u=>x(this,null,function*(){if(u)try{d.isEdit&&d.data_id?(yield oe(d.data_id,I({},r)),w.success("更新成功")):(yield ie(I({},r)),w.success("创建成功")),d.visible=!1,g()}catch(i){w.error("操作失败")}}))},O=l=>{pe.confirm("确认删除该工作流程吗？","删除确认",{type:"warning"}).then(()=>x(this,null,function*(){try{yield se([l.id]),w.success("删除成功"),g()}catch(e){w.error("删除失败")}})).catch(()=>{})};return J(()=>{g()}),(l,e)=>{var u;return Q(),X("div",ue,[c("div",me,[c("div",ce,[t(a(b),{modelValue:k.keyword,"onUpdate:modelValue":e[0]||(e[0]=i=>k.keyword=i),placeholder:"搜索名称或手机号",clearable:"",onClear:V,onKeydown:Y(V,["enter"])},null,8,["modelValue"]),t(a(_),{plain:!0,onClick:V},{default:p(()=>[f("搜索")]),_:1}),t(a(_),{type:"primary",onClick:K},{default:p(()=>[f("创建工作流程")]),_:1})]),c("div",fe,"总数："+E(o.total),1)]),t(a(ne),{data:n.value,stripe:"",style:{width:"100%"},"empty-text":"暂无数据"},{default:p(()=>[t(a(h),{prop:"id",label:"ID",width:"80"}),t(a(h),{prop:"name",label:"名称"}),t(a(h),{prop:"phone",label:"手机号"}),t(a(h),{prop:"description",label:"描述","show-overflow-tooltip":""}),t(a(h),{prop:"config",label:"配置信息","show-overflow-tooltip":""}),t(a(h),{label:"操作",width:"220"},{default:p(i=>[t(a(_),{size:"small",onClick:v=>j(i.row)},{default:p(()=>[f("查看")]),_:2},1032,["onClick"]),t(a(_),{size:"small",type:"primary",onClick:v=>F(i.row)},{default:p(()=>[f("编辑")]),_:2},1032,["onClick"]),t(a(_),{size:"small",type:"danger",onClick:v=>O(i.row)},{default:p(()=>[f("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),c("div",ge,[t(a(de),{background:"",layout:"prev, pager, next, sizes, total","page-size":o.limit,"current-page":o.page,"page-sizes":[10,20,50,100],total:o.total,onSizeChange:C,onCurrentChange:z},null,8,["page-size","current-page","total"])]),t(a(N),{modelValue:s.visible,"onUpdate:modelValue":e[2]||(e[2]=i=>s.visible=i),width:"700px",title:"工作流程 - "+(((u=s.data)==null?void 0:u.name)||"")},{footer:p(()=>[t(a(_),{onClick:e[1]||(e[1]=i=>s.visible=!1)},{default:p(()=>[f("关闭")]),_:1})]),default:p(()=>{var i,v,U,W;return[c("div",ve,[c("div",null,[_e,f(E((i=s.data)==null?void 0:i.name),1)]),c("div",null,[be,f(E((v=s.data)==null?void 0:v.phone),1)]),ye,t(a(b),{type:"textarea",rows:3,"model-value":(U=s.data)==null?void 0:U.description,disabled:""},null,8,["model-value"]),he,t(a(b),{type:"textarea",rows:8,"model-value":(W=s.data)==null?void 0:W.config,disabled:""},null,8,["model-value"])])]}),_:1},8,["modelValue","title"]),t(a(N),{modelValue:d.visible,"onUpdate:modelValue":e[7]||(e[7]=i=>d.visible=i),width:"720px",title:d.isEdit?"编辑工作流程":"创建工作流程"},{footer:p(()=>[t(a(_),{onClick:T},{default:p(()=>[f("取消")]),_:1}),t(a(_),{type:"primary",onClick:q},{default:p(()=>[f(E(d.isEdit?"保存":"创建"),1)]),_:1})]),default:p(()=>[t(a(re),{model:r,rules:$,ref_key:"formRef",ref:D,"label-width":"120px",class:"space-y-2"},{default:p(()=>[t(a(S),{label:"名称",prop:"name"},{default:p(()=>[t(a(b),{modelValue:r.name,"onUpdate:modelValue":e[3]||(e[3]=i=>r.name=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"手机号",prop:"phone"},{default:p(()=>[t(a(b),{modelValue:r.phone,"onUpdate:modelValue":e[4]||(e[4]=i=>r.phone=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"描述",prop:"description"},{default:p(()=>[t(a(b),{type:"textarea",rows:3,modelValue:r.description,"onUpdate:modelValue":e[5]||(e[5]=i=>r.description=i)},null,8,["modelValue"])]),_:1}),t(a(S),{label:"配置信息(JSON或文本)",prop:"config"},{default:p(()=>[t(a(b),{type:"textarea",rows:10,modelValue:r.config,"onUpdate:modelValue":e[6]||(e[6]=i=>r.config=i)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}}),je=te(we,[["__scopeId","data-v-de3da5d6"]]);export{je as default};
