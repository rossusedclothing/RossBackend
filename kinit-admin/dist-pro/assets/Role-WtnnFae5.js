var oe=Object.defineProperty;var F=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var T=(u,i,l)=>i in u?oe(u,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):u[i]=l,G=(u,i)=>{for(var l in i||(i={}))le.call(i,l)&&T(u,l,i[l]);if(F)for(var l of F(i))ie.call(i,l)&&T(u,l,i[l]);return u};var p=(u,i,l)=>new Promise((y,R)=>{var A=s=>{try{_(l.next(s))}catch(m){R(m)}},D=s=>{try{_(l.throw(s))}catch(m){R(m)}},_=s=>s.done?y(s.value):Promise.resolve(s.value).then(A,D);_((l=l.apply(u,i)).next())});import{f as re,a as n,Q as I,M as o,u as a,F as b,H as S,N as V,ag as z,K as g,a9 as N,h as U,i as se,G as d,q as j,E as ne,L as q}from"./vue-chunks-wbK7PffK.js";import{g as H,a as ue,d as de,b as me,p as pe}from"./role-BRNJ_dag.js";import{u as ce,_ as fe}from"./Table.vue_vue_type_script_lang-C8htGDV6.js";import{d as ge,v}from"./index-SAHUQZ2g.js";/* empty css                  */import{_ as ve}from"./Search.vue_vue_type_script_setup_true_lang-DSCbi6Eq.js";import{_ as _e}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bq-Mkqar.js";import{_ as we}from"./Write.vue_vue_type_script_setup_true_lang-D-K4gM_y.js";import he from"./AuthManage-HWGjmlMa.js";import{_ as be}from"./Dialog.vue_vue_type_style_index_0_lang-Bhm9ynpg.js";import{s as ye}from"./dict-DJyIMlYA.js";import{u as Re}from"./dict-D8O779xT.js";import{V as K}from"./element-plus-C0vem28W.js";/* empty css                       *//* empty css                 *//* empty css                   *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css               *//* empty css                      *//* empty css                  *//* empty css                        *//* empty css                */import"./useForm-B5RQKQQi.js";/* empty css                     *//* empty css               *//* empty css                 *//* empty css                          *//* empty css                       *//* empty css                       *//* empty css                   *//* empty css                *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-BFkgkg1x.js";import"./wang-editor-K_dPeC8b.js";/* empty css                   *//* empty css                    *//* empty css                         */import"./_Uint8Array-DZlgfqcV.js";import"./useIcon-DF_xcSd1.js";import"./useValidator-UROf_CnT.js";import"./tree-D8D4nCL3.js";import"./menu-CtZuxorH.js";import"./dept-DZp9JQ7b.js";/* empty css                  */import"./dict-D1Ddn9_W.js";const ht=re({name:"AuthRole",__name:"Role",setup(u){const{t:i}=ge(),{tableRegister:l,tableState:y,tableMethods:R}=ce({fetchDataApi:()=>p(this,null,function*(){const{pageSize:t,currentPage:e}=y,r=yield ue(G({page:a(e),limit:a(t)},a($)));return{list:r.data||[],total:r.count||0}}),fetchDelApi:t=>p(this,null,function*(){return(yield de(t)).code===200})}),{dataList:A,loading:D,total:_,pageSize:s,currentPage:m}=y,{getList:w,delList:Q}=R;let E=n([]);p(this,null,function*(){const e=yield Re().getDictObj(["sys_vadmin_data_range"]);E.value=e.sys_vadmin_data_range});const J=I([{field:"id",label:"角色编号",show:!1,disabled:!1},{field:"name",label:"角色名称",show:!0,disabled:!0},{field:"role_key",label:"权限字符",show:!0},{field:"data_range",label:"数据范围",show:!0,slots:{default:t=>{const e=t.row;return o(b,null,[o("div",null,[ye(a(E),e.data_range.toString())])])}}},{field:"order",label:"显示顺序",show:!0},{field:"disabled",label:"角色状态",show:!0,slots:{default:t=>{const e=t.row;return o(b,null,[o(K,{modelValue:!e.disabled,disabled:!0},null)])}}},{field:"is_admin",label:"最高权限",show:!0,slots:{default:t=>{const e=t.row;return o(b,null,[o(K,{modelValue:e.is_admin,disabled:!0},null)])}}},{field:"create_datetime",label:"创建时间",show:!0},{field:"action",width:"170px",label:"操作",show:!0,slots:{default:t=>{const e=t.row,r=["auth.role.update"],x=["auth.role.delete"];return o(b,null,[S(o(v,{type:"primary",link:!0,size:"small",onClick:()=>Z(e)},{default:()=>[g("编辑")]}),[[V,e.id!==1],[z("hasPermi"),r]]),S(o(v,{type:"primary",link:!0,size:"small",onClick:()=>Y(e)},{default:()=>[g("权限管理")]}),[[V,e.id!==1]]),S(o(v,{type:"danger",loading:L.value,link:!0,size:"small",onClick:()=>X(e)},{default:()=>[g("删除")]}),[[V,e.id!==1],[z("hasPermi"),x]])])}}}]),W=I([{field:"name",label:"角色名称",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"role_key",label:"权限字符",component:"Input",componentProps:{clearable:!1,style:{width:"214px"}}},{field:"disabled",label:"状态",component:"Select",componentProps:{style:{width:"214px"},options:[{label:"正常",value:!1},{label:"停用",value:!0}]}}]),$=n({}),M=t=>{m.value=1,$.value=t,w()},L=n(!1),X=t=>p(this,null,function*(){L.value=!0,yield Q(!0,[t.id]).finally(()=>{L.value=!1})}),O=n(),Y=t=>p(this,null,function*(){var r;const e=yield H(t.id);e&&(e.data.data_range=e.data.data_range.toString(),h.value=e.data,(r=O.value)==null||r.openDrawer())}),c=n(!1),C=n(""),h=n(),k=n(""),B=n(),P=n(!1),Z=t=>p(this,null,function*(){const e=yield H(t.id);e&&(C.value="编辑角色",k.value="edit",e.data.data_range=e.data.data_range.toString(),h.value=e.data,c.value=!0)}),ee=()=>{C.value="新增角色",k.value="add",h.value=void 0,c.value=!0},te=()=>p(this,null,function*(){const t=a(B),e=yield t==null?void 0:t.submit();if(e){P.value=!0;try{const r=n({});k.value==="add"?(r.value=yield me(e),r.value&&(c.value=!1,w())):k.value==="edit"&&(r.value=yield pe(e),r.value&&(c.value=!1,w()))}finally{P.value=!1}}});return(t,e)=>{const r=N("ElCol"),x=N("ElRow"),ae=z("hasPermi");return U(),se(b,null,[o(a(_e),null,{default:d(()=>[o(a(ve),{schema:W,onReset:M,onSearch:M},null,8,["schema"]),o(a(fe),{"current-page":a(m),"onUpdate:currentPage":e[0]||(e[0]=f=>j(m)?m.value=f:null),"page-size":a(s),"onUpdate:pageSize":e[1]||(e[1]=f=>j(s)?s.value=f:null),showAction:"",columns:J,"default-expand-all":"","node-key":"id",data:a(A),loading:a(D),pagination:{total:a(_)},onRegister:a(l),onRefresh:a(w)},{toolbar:d(()=>[o(x,{gutter:10},{default:d(()=>[o(r,{span:1.5},{default:d(()=>[S((U(),ne(a(v),{type:"primary",onClick:ee},{default:d(()=>[g("新增角色")]),_:1})),[[ae,["auth.role.create"]]])]),_:1})]),_:1})]),_:1},8,["current-page","page-size","columns","data","loading","pagination","onRegister","onRefresh"])]),_:1}),o(a(be),{modelValue:c.value,"onUpdate:modelValue":e[3]||(e[3]=f=>c.value=f),title:C.value,height:650},{footer:d(()=>[o(a(v),{type:"primary",loading:P.value,onClick:te},{default:d(()=>[g(q(a(i)("exampleDemo.save")),1)]),_:1},8,["loading"]),o(a(v),{onClick:e[2]||(e[2]=f=>c.value=!1)},{default:d(()=>[g(q(a(i)("dialogDemo.close")),1)]),_:1})]),default:d(()=>[o(we,{ref_key:"writeRef",ref:B,"current-row":h.value},null,8,["current-row"])]),_:1},8,["modelValue","title"]),o(he,{ref_key:"authManageRef",ref:O,"current-row":h.value,onGetList:a(w)},null,8,["current-row","onGetList"])],64)}}});export{ht as default};
