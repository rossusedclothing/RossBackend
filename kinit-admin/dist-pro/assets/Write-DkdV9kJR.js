var c=(b,m,o)=>new Promise((f,l)=>{var d=t=>{try{r(o.next(t))}catch(i){l(i)}},v=t=>{try{r(o.throw(t))}catch(i){l(i)}},r=t=>t.done?f(t.value):Promise.resolve(t.value).then(d,v);r((o=o.apply(b,m)).next())});import{u as k,F as C}from"./useForm-BREZWcm3.js";import{u as F}from"./useValidator-B2HgF5Uc.js";import{l as A,aB as x,Z as B,U as w,S as D,F as R,a as y,m as E,M as S,O as V,u as _}from"./vue-chunks-o2h5QaLn.js";import{t as M}from"./index-BSaZkSQ-.js";import{_ as N}from"./ContentWrap.vue_vue_type_script_setup_true_lang-Bhi8rX8m.js";import{a as O,b as q,p as T,c as $}from"./issue-txMQzhJk.js";import{b as a}from"./element-plus-BkD8NzPH.js";/* empty css                     *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  *//* empty css                 *//* empty css                    *//* empty css                          *//* empty css                       *//* empty css                       *//* empty css                  *//* empty css                  *//* empty css                   *//* empty css                *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-CeSE9S1A.js";import"./wang-editor-D1s6zAlo.js";/* empty css                   *//* empty css                    *//* empty css                      *//* empty css                */const ge=A({name:"HelpIssueForm",__name:"Write",setup(b,{expose:m}){const{required:o}=F(),{push:f,currentRoute:l}=x(),d={customAlert:(e,s)=>{switch(s){case"success":a.success(e);break;case"info":a.info(e);break;case"warning":a.warning(e);break;case"error":a.error(e);break;default:a.info(e);break}},autoFocus:!1,scroll:!0,readOnly:!1,uploadImgShowBase64:!0,placeholder:"请输入内容..."},v=B([{field:"title",label:"标题名称",component:"Input",colProps:{span:24},componentProps:{style:{width:"100%"}},formItemProps:{rules:[o()]}},{field:"content",label:"内容",colProps:{span:24},component:"Editor",componentProps:{style:{width:"100%"},editorConfig:d,editorId:"issueContent"},formItemProps:{rules:[o()]}},{field:"category_id",label:"问题类别",colProps:{span:24},component:"Select",componentProps:{style:{width:"100%"}},formItemProps:{rules:[o()]},optionApi:()=>c(this,null,function*(){return(yield O()).data})},{field:"",label:"",colProps:{span:24},formItemProps:{slots:{default:()=>w(R,null,[w(M,{loading:u.value,type:"primary",onClick:I},{default:()=>[D("立即保存")]})])}}}]),{formRegister:r,formMethods:t}=k(),{getFormData:i,getElFormExpose:P,setValues:h}=t,p=y(""),u=y(!1);c(this,null,function*(){const e=l.value.query.id;if(e){p.value="edit";const s=yield $(Number(e));s?h(s.data):f("/404")}else p.value="add"});const I=()=>c(this,null,function*(){const e=yield P();if(yield e==null?void 0:e.validate()){u.value=!0;const g=yield i();if(!g)return u.value=!1,a.error("未获取到数据");const n=y();try{p.value==="add"?(n.value=yield q(g),n.value&&(e==null||e.resetFields(),a.success("新增成功"))):p.value==="edit"&&(n.value=yield T(g),n.value&&(h(n.value.data),a.success("更新成功")))}finally{u.value=!1}}});return m({submit:I}),(e,s)=>(E(),S(_(N),null,{default:V(()=>[w(_(C),{onRegister:_(r),schema:v,labelPosition:"top"},null,8,["onRegister","schema"])]),_:1}))}});export{ge as default};
